# Task 1.3: Add Catalog API Endpoints

## Status: [ ] Not Started

## Goal
Expose catalog via REST API.

## Output File
`api/routers/data.py` (ADD to existing)

## Dependencies
- Task 1.2 completed

## Code to ADD

```python
# ADD these endpoints to api/routers/data.py

from src.data_manager.catalog_loader import get_catalog

@router.get("/catalog")
async def list_catalog():
    """List all datasets in catalog."""
    cat = get_catalog()
    datasets = []
    for ds_id in cat.list_datasets():
        meta = cat.get_metadata(ds_id)
        datasets.append({
            "id": ds_id,
            "name": meta.get("description", ds_id),
            "provider": meta.get("provider"),
            "variables": meta.get("variables", []),
            "latency": meta.get("latency"),
            "latency_badge": meta.get("latency_badge"),
            "status": meta.get("status"),
        })
    return {"datasets": datasets, "count": len(datasets)}


@router.get("/catalog/search")
async def search_catalog(
    variables: str = None,
    latency: str = None,
    status: str = "available",
):
    """Search datasets by criteria."""
    cat = get_catalog()
    var_list = variables.split(",") if variables else None
    results = cat.search(variables=var_list, latency_badge=latency, status=status)
    return {"matches": results, "count": len(results)}
```

## Test Command
```bash
# Start API first
source .venv/bin/activate
uvicorn api.main:app --reload &

# Test endpoints
curl http://localhost:8000/catalog
curl "http://localhost:8000/catalog/search?status=available"
```

## Done Criteria
- [ ] `/catalog` returns all datasets
- [ ] `/catalog/search?variables=sla` filters correctly
- [ ] No import errors on startup

## Next Task
â†’ 2.1_cygnss_client.md
